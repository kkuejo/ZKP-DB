# ZKP-DB ãƒ‡ãƒ¢ã‚¬ã‚¤ãƒ‰ - ã‚·ã‚¹ãƒ†ãƒ ã§ã§ãã‚‹ã“ã¨

## ðŸŽ¯ ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã®æ©Ÿèƒ½

### 1. æš—å·åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã§ã®çµ±è¨ˆè¨ˆç®—

**ã‚·ãƒŠãƒªã‚ª**: è£½è–¬ä¼šç¤¾ãŒæ‚£è€…ãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆã‚’çŸ¥ã‚ŠãŸã„ãŒã€å€‹åˆ¥ã®æ‚£è€…æƒ…å ±ã¯è¦‹ã‚‰ã‚Œãªã„

**å®Ÿç¾æ¸ˆã¿**:
```
âœ“ 100äººã®æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–ï¼ˆ192MBï¼‰
âœ“ æš—å·åŒ–ã•ã‚ŒãŸã¾ã¾å¹³å‡å€¤ã‚’è¨ˆç®—:
  - å¹³å‡å¹´é½¢: 55.2æ­³
  - å¹³å‡è¡€åœ§: 126.9 mmHg
  - å¹³å‡è¡€ç³–å€¤: 100.6 mg/dL
```

**ã‚„ã£ã¦ã¿ã‚‹**:
```bash
source venv/bin/activate
python python/homomorphic_encryption.py
```

**ä¾¡å€¤**:
- å€‹ã€…ã®æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã¯èª°ã«ã‚‚è¦‹ã‚‰ã‚Œãªã„
- çµ±è¨ˆçš„ãªçŸ¥è¦‹ã¯å¾—ã‚‰ã‚Œã‚‹
- ãƒ‡ãƒ¼ã‚¿æä¾›è€…ãŒç§˜å¯†éµã‚’ä¿æŒ

---

### 2. ãƒ‡ãƒ¼ã‚¿ã®æ­£å½“æ€§è¨¼æ˜Žï¼ˆã‚¼ãƒ­çŸ¥è­˜è¨¼æ˜Žï¼‰

**ã‚·ãƒŠãƒªã‚ª**: ãƒ‡ãƒ¼ã‚¿ãŒæ”¹ã–ã‚“ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’è¨¼æ˜Žã—ãŸã„ãŒã€å…·ä½“çš„ãªå€¤ã¯æ˜Žã‹ã—ãŸããªã„

**å®Ÿç¾æ¸ˆã¿**:
```
å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼ˆç§˜å¯†ï¼‰:
  å¹´é½¢: 34æ­³
  è¡€åœ§: 124/73 mmHg
  è¡€ç³–å€¤: 97 mg/dL
  ã‚³ãƒ¬ã‚¹ãƒ†ãƒ­ãƒ¼ãƒ«: 239 mg/dL

ç”Ÿæˆã•ã‚ŒãŸè¨¼æ˜Ž: 804ãƒã‚¤ãƒˆ
æ¤œè¨¼çµæžœ: âœ“ OK

å…¬é–‹æƒ…å ±:
  - dataHashï¼ˆæ”¹ã–ã‚“æ¤œå‡ºç”¨ï¼‰
  - isValid = 1ï¼ˆãƒ‡ãƒ¼ã‚¿ã¯æœ‰åŠ¹ç¯„å›²å†…ï¼‰

èª°ã«ã‚‚åˆ†ã‹ã‚‰ãªã„:
  - å…·ä½“çš„ãªå¹´é½¢
  - å…·ä½“çš„ãªè¡€åœ§
  - ãã®ä»–ã™ã¹ã¦ã®å€¤
```

**æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã§è©¦ã™**:
```bash
# å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ä½œæˆ
cat > proofs/my_test.json << 'EOF'
{
  "age": 50,
  "blood_pressure_systolic": 140,
  "blood_pressure_diastolic": 90,
  "blood_sugar": 110,
  "cholesterol": 220,
  "salt": 77777777
}
EOF

# è¨¼æ˜Žç”Ÿæˆ
npx snarkjs groth16 fullprove \
  proofs/my_test.json \
  circuits/build/data_verification_js/data_verification.wasm \
  keys/data_verification_0000.zkey \
  proofs/my_proof.json \
  proofs/my_public.json

# æ¤œè¨¼
npx snarkjs groth16 verify \
  keys/verification_key.json \
  proofs/my_public.json \
  proofs/my_proof.json

# çµæžœç¢ºèª
cat proofs/my_public.json
```

---

### 3. ä¸æ­£ãªãƒ‡ãƒ¼ã‚¿ã¯è¨¼æ˜Žã§ããªã„

**ã‚·ãƒŠãƒªã‚ª**: ç¯„å›²å¤–ã®ãƒ‡ãƒ¼ã‚¿ã§è¨¼æ˜Žã‚’è©¦ã¿ã‚‹

**è©¦ã—ã¦ã¿ã‚‹ - å¹´é½¢ãŒç¯„å›²å¤–**:
```bash
# ä¸æ­£ãƒ‡ãƒ¼ã‚¿ï¼ˆå¹´é½¢150æ­³ã¯ç¯„å›²å¤–ï¼‰
cat > proofs/invalid_age.json << 'EOF'
{
  "age": 150,
  "blood_pressure_systolic": 130,
  "blood_pressure_diastolic": 85,
  "blood_sugar": 105,
  "cholesterol": 210,
  "salt": 99999999
}
EOF

# è¨¼æ˜Žç”Ÿæˆ
npx snarkjs groth16 fullprove \
  proofs/invalid_age.json \
  circuits/build/data_verification_js/data_verification.wasm \
  keys/data_verification_0000.zkey \
  proofs/invalid_proof.json \
  proofs/invalid_public.json

# å…¬é–‹ä¿¡å·ç¢ºèª
cat proofs/invalid_public.json
# â†’ isValid ãŒ 0 ã«ãªã£ã¦ã„ã‚‹ã¯ãš
```

**è©¦ã—ã¦ã¿ã‚‹ - è¡€åœ§ãŒç¯„å›²å¤–**:
```bash
cat > proofs/invalid_bp.json << 'EOF'
{
  "age": 45,
  "blood_pressure_systolic": 250,
  "blood_pressure_diastolic": 150,
  "blood_sugar": 105,
  "cholesterol": 210,
  "salt": 88888888
}
EOF

npx snarkjs groth16 fullprove \
  proofs/invalid_bp.json \
  circuits/build/data_verification_js/data_verification.wasm \
  keys/data_verification_0000.zkey \
  proofs/invalid_bp_proof.json \
  proofs/invalid_bp_public.json

cat proofs/invalid_bp_public.json
```

**ä¾¡å€¤**:
- ãƒ‡ãƒ¼ã‚¿ã®å“è³ªä¿è¨¼
- ä¸æ­£ãªãƒ‡ãƒ¼ã‚¿ã‚’æŽ’é™¤
- ãƒ‡ãƒ¼ã‚¿ãƒžãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã®ä¿¡é ¼æ€§

---

### 4. å®Ÿéš›ã®æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã§è¨¼æ˜Ž

**æ‚£è€…P0001ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦è¨¼æ˜Ž**:
```bash
# data/patients.jsonã‹ã‚‰æ‚£è€…P0001ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
cat > proofs/patient_P0001.json << 'EOF'
{
  "age": 34,
  "blood_pressure_systolic": 124,
  "blood_pressure_diastolic": 73,
  "blood_sugar": 97,
  "cholesterol": 239,
  "salt": 11111111
}
EOF

# è¨¼æ˜Žç”Ÿæˆ
npx snarkjs groth16 fullprove \
  proofs/patient_P0001.json \
  circuits/build/data_verification_js/data_verification.wasm \
  keys/data_verification_0000.zkey \
  proofs/P0001_proof.json \
  proofs/P0001_public.json

# æ¤œè¨¼
npx snarkjs groth16 verify \
  keys/verification_key.json \
  proofs/P0001_public.json \
  proofs/P0001_proof.json

echo "âœ“ æ‚£è€…P0001ã®ãƒ‡ãƒ¼ã‚¿ãŒæ­£å½“ã§ã‚ã‚‹ã“ã¨ã‚’è¨¼æ˜Žã—ã¾ã—ãŸ"
echo "ã—ã‹ã—ã€å…·ä½“çš„ãªå¹´é½¢ã€è¡€åœ§ãªã©ã¯èª°ã«ã‚‚åˆ†ã‹ã‚Šã¾ã›ã‚“"
```

---

## ðŸ“Š ãƒ‡ãƒ¼ã‚¿ã®ç¯„å›²åˆ¶ç´„

å›žè·¯ï¼ˆcircuits/data_verification.circomï¼‰ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹åˆ¶ç´„:

| é …ç›® | æœ€å°å€¤ | æœ€å¤§å€¤ | èª¬æ˜Ž |
|------|--------|--------|------|
| å¹´é½¢ | 0 | 120 | æ­³ |
| åŽç¸®æœŸè¡€åœ§ | 80 | 200 | mmHg |
| æ‹¡å¼µæœŸè¡€åœ§ | 50 | 120 | mmHg |
| è¡€ç³–å€¤ | 50 | 300 | mg/dL |
| ã‚³ãƒ¬ã‚¹ãƒ†ãƒ­ãƒ¼ãƒ« | 100 | 400 | mg/dL |

ã“ã‚Œã‚‰ã®ç¯„å›²å†…ã§ã‚ã‚Œã° `isValid = 1`ã€ç¯„å›²å¤–ãªã‚‰ `isValid = 0` ã¨ãªã‚Šã¾ã™ã€‚

---

## ðŸŽ¬ å®Ÿç”¨ã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª1: ãƒ‡ãƒ¼ã‚¿ãƒžãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹

```
[Aç—…é™¢]
  â†“ 100äººã®æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–
  â†“ å„æ‚£è€…ã®ZKPè¨¼æ˜Žã‚’ç”Ÿæˆ
  â†“ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

[ZKP-DBãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ]
  â†“ ZKPè¨¼æ˜Žã‚’æ¤œè¨¼
  â†“ ã™ã¹ã¦isValid = 1ã‚’ç¢ºèª
  â†“ ãƒ‡ãƒ¼ã‚¿ã‚’æŽ²è¼‰

[Bè£½è–¬ä¼šç¤¾]
  â†“ æš—å·åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  â†“ æš—å·åŒ–ã•ã‚ŒãŸã¾ã¾çµ±è¨ˆåˆ†æž
  âœ“ æ–°è–¬é–‹ç™ºã®çŸ¥è¦‹ã‚’å¾—ã‚‹

çµæžœ:
- ç—…é™¢: ãƒ‡ãƒ¼ã‚¿åŽç›ŠåŒ–ã€ç§˜å¯†éµä¿æŒ
- è£½è–¬ä¼šç¤¾: ç ”ç©¶ãƒ‡ãƒ¼ã‚¿å–å¾—ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·
- æ‚£è€…: å€‹äººæƒ…å ±å®Œå…¨ä¿è­·
```

### ã‚·ãƒŠãƒªã‚ª2: åŒ»ç™‚AIé–‹ç™º

```
[è¤‡æ•°ã®ç—…é™¢]
  â†“ å„ã€…ãŒæ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–
  â†“ ZKPã§ãƒ‡ãƒ¼ã‚¿ã®æ­£å½“æ€§ã‚’è¨¼æ˜Ž

[AIä¼æ¥­]
  â†“ æš—å·åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆ
  â†“ æš—å·åŒ–ã•ã‚ŒãŸã¾ã¾ãƒ¢ãƒ‡ãƒ«è¨“ç·´
  âœ“ è¨ºæ–­æ”¯æ´AIã‚’é–‹ç™º

çµæžœ:
- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§é«˜ç²¾åº¦AI
- æ‚£è€…ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼å®Œå…¨ä¿è­·
- GDPR/å€‹äººæƒ…å ±ä¿è­·æ³•æº–æ‹ 
```

---

## ðŸ” ç¢ºèªã§ãã‚‹ã“ã¨

### ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª

**ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«**:
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
ls -lh data/
# patients.json - å…ƒãƒ‡ãƒ¼ã‚¿ï¼ˆ39KBï¼‰
# patients.csv - CSVå½¢å¼ï¼ˆ9.6KBï¼‰
# encrypted_patients.pkl - æš—å·åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆ192MBï¼‰

# éµãƒ•ã‚¡ã‚¤ãƒ«
ls -lh keys/
# context.pkl - HEç§˜å¯†éµï¼ˆ690KBï¼‰
# data_verification_0000.zkey - ZKPè¨¼æ˜Žéµï¼ˆ623KBï¼‰
# verification_key.json - ZKPæ¤œè¨¼éµï¼ˆ3.3KBï¼‰

# è¨¼æ˜Žãƒ•ã‚¡ã‚¤ãƒ«
ls -lh proofs/
# proof.json - è¨¼æ˜Žï¼ˆ804Bï¼‰
# public.json - å…¬é–‹ä¿¡å·ï¼ˆ103Bï¼‰
```

**è¨¼æ˜Žã®ä¸­èº«ã‚’è¦‹ã‚‹**:
```bash
# è¨¼æ˜Žï¼ˆGroth16ã®æ¥•å††æ›²ç·šç‚¹ï¼‰
cat proofs/proof.json | jq '.pi_a, .pi_b, .pi_c'

# å…¬é–‹ä¿¡å·
cat proofs/public.json | jq '.'
# [0]: dataHash
# [1]: isValid (1 = æœ‰åŠ¹, 0 = ç„¡åŠ¹)
# [2]: salt
```

---

## ðŸ’¡ æŠ€è¡“çš„è©³ç´°

### æº–åŒåž‹æš—å·ï¼ˆCKKSï¼‰
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: 128ãƒ“ãƒƒãƒˆï¼ˆç¾ä»£ã®æ¨™æº–ï¼‰
- **å¤šé …å¼æ¬¡æ•°**: 8192
- **ã‚¹ã‚±ãƒ¼ãƒ«**: 2^40
- **ä¹—ç®—æ·±åº¦**: 3-4å›ž

### ã‚¼ãƒ­çŸ¥è­˜è¨¼æ˜Žï¼ˆGroth16ï¼‰
- **æ›²ç·š**: BN128 (BN254)
- **è¨¼æ˜Žã‚µã‚¤ã‚º**: 128ãƒã‚¤ãƒˆï¼ˆ3ã¤ã®æ¥•å††æ›²ç·šç‚¹ï¼‰+ JSONæ§‹é€ 
- **æ¤œè¨¼æ™‚é–“**: æ•°ãƒŸãƒªç§’
- **å›žè·¯åˆ¶ç´„**: 1,347å€‹

### æ€§èƒ½

| æ“ä½œ | æ™‚é–“ | ã‚µã‚¤ã‚º |
|------|------|--------|
| ãƒ‡ãƒ¼ã‚¿æš—å·åŒ– | æ•°ç§’ | 5000å€è†¨å¼µ |
| æš—å·åŒ–è¨ˆç®— | æ•°ç§’ã€œæ•°åç§’ | - |
| è¨¼æ˜Žç”Ÿæˆ | æ•°ç§’ | 804ãƒã‚¤ãƒˆ |
| è¨¼æ˜Žæ¤œè¨¼ | æ•°ãƒŸãƒªç§’ | - |

---

## ðŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã•ã‚‰ã«è©¦ã›ã‚‹ã“ã¨

1. **ç•°ãªã‚‹æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã§è¨¼æ˜Ž**
   - data/patients.csvã‹ã‚‰å¥½ããªæ‚£è€…ã‚’é¸ã¶
   - ãã®æ‚£è€…ã®ZKPè¨¼æ˜Žã‚’ç”Ÿæˆ

2. **å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ**
   - å¹´é½¢120æ­³ï¼ˆã‚®ãƒªã‚®ãƒªæœ‰åŠ¹ï¼‰
   - å¹´é½¢121æ­³ï¼ˆç„¡åŠ¹ï¼‰

3. **è¤‡æ•°æ‚£è€…ã®è¨¼æ˜Žã‚’ä¸€æ‹¬ç”Ÿæˆ**
   - å…¨100äººã®è¨¼æ˜Žã‚’ç”Ÿæˆ
   - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå…¨ä½“ã®æ­£å½“æ€§ã‚’è¨¼æ˜Ž

4. **ã‚«ã‚¹ã‚¿ãƒ å›žè·¯ä½œæˆ**
   - circuits/data_verification.circomã‚’ç·¨é›†
   - æ–°ã—ã„åˆ¶ç´„ã‚’è¿½åŠ ï¼ˆä¾‹: BMIç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼‰

---

## ðŸ“ˆ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

### ç¾åœ¨ã®ãƒ‡ãƒ¢
- æ‚£è€…æ•°: 100äºº
- å‡¦ç†æ™‚é–“: æ•°ç§’

### æœ¬ç•ªæƒ³å®š
- æ‚£è€…æ•°: 10ä¸‡ã€œ100ä¸‡äºº
- å‡¦ç†æ™‚é–“: åˆ†ã€œæ™‚é–“
- å¯¾ç­–: ä¸¦åˆ—å‡¦ç†ã€GPUã€ã‚¯ãƒ©ã‚¦ãƒ‰

---

## ðŸŽ¯ ã¾ã¨ã‚

âœ… **å®Ÿè¨¼ã•ã‚ŒãŸã“ã¨**:
1. ãƒ‡ãƒ¼ã‚¿ã‚’æš—å·åŒ–ã—ãŸã¾ã¾çµ±è¨ˆè¨ˆç®—å¯èƒ½
2. å…·ä½“çš„ãªå€¤ã‚’æ˜Žã‹ã•ãšã«ãƒ‡ãƒ¼ã‚¿ã®æ­£å½“æ€§ã‚’è¨¼æ˜Žå¯èƒ½
3. ä¸æ­£ãªãƒ‡ãƒ¼ã‚¿ã¯æ¤œå‡ºå¯èƒ½
4. å®Ÿç”¨çš„ãªæ€§èƒ½ï¼ˆè¨¼æ˜Žã‚µã‚¤ã‚º804ãƒã‚¤ãƒˆã€æ¤œè¨¼æ•°ãƒŸãƒªç§’ï¼‰

âœ… **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**:
1. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ãƒ‡ãƒ¼ã‚¿ãƒžãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹å®Ÿç¾å¯èƒ½
2. è¦åˆ¶ï¼ˆGDPR/å€‹äººæƒ…å ±ä¿è­·æ³•ï¼‰æº–æ‹ 
3. ãƒ‡ãƒ¼ã‚¿åŽç›ŠåŒ–ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã®ä¸¡ç«‹
4. åŒ»ç™‚AIé–‹ç™ºã®åŠ é€Ÿ

æ¬¡: ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â†’ å•†ç”¨åŒ–
